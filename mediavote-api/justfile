# vi:ft=make

set shell := ["fish", "-c"]

proj := "github.com/nanozuki/crows.moe/mediavote-api/"

default:
	just --list

test-all:
	ENV=testing docker-compose run server go test ./...

test MODEL:
	ENV=testing docker-compose run server go test {{proj}}{{MODEL}}

run:
	ENV=dev docker-compose up

down:
	docker-compose down -v

gen:
	go generate

build-image TAG:
	docker build --platform=linux/amd64 -t ghcr.io/nanozuki/mediavote-api:{{TAG}} .
	docker push ghcr.io/nanozuki/mediavote-api:{{TAG}}
